<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Rebeja (Posts about Emacs)</title><link>https://blog.rebeja.eu/</link><description></description><atom:link rel="self" href="https://blog.rebeja.eu/categories/emacs.xml" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2018 &lt;a href="mailto:petru.rebeja@gmail.com"&gt;Petru Rebeja&lt;/a&gt; </copyright><lastBuildDate>Tue, 27 Nov 2018 16:26:32 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Use Emacs sql-mode to connect to database on a Docker image</title><link>https://blog.rebeja.eu/posts/use-emacs-sql-mode-to-connect-to-database-on-a-docker-image/</link><dc:creator>Petru Rebeja</dc:creator><description>&lt;p&gt;
While working on a project I had to load and process some resources from a MySQL database. I had a database dump and all I needed was to &lt;code&gt;sudo apt-get install mysql&lt;/code&gt; but I decided against it because that would just bloat my OS with software used only once and drain my laptop battery with the service running in the background.
&lt;/p&gt;

&lt;p&gt;
Instead, I decided to restore the database on a Docker image for MySQL and query the data using &lt;code&gt;mysql-client&lt;/code&gt;.
&lt;/p&gt;
&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Install &lt;code&gt;mysql-client&lt;/code&gt; locally&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;p&gt;
This one is simple; just run:
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get install mysql-client
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;Install Docker on Ubuntu&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;p&gt;
The first thing to do is to head to &lt;a href="https://docs.docker.com/engine/installation/linux/ubuntu/#install-docker"&gt;Docker documentation&lt;/a&gt; for instalation instructions which I've copied here:
&lt;/p&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Install packages to allow &lt;code&gt;apt&lt;/code&gt; to use a repository over HTTPS:
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get install &lt;span class="se"&gt;\&lt;/span&gt;
    apt-transport-https &lt;span class="se"&gt;\&lt;/span&gt;
    ca-certificates &lt;span class="se"&gt;\&lt;/span&gt;
    curl &lt;span class="se"&gt;\&lt;/span&gt;
    software-properties-common
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Add the official GPG key for Docker
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl -fsSL https://download.docker.com/linux/ubuntu/gpg &lt;span class="p"&gt;|&lt;/span&gt; sudo apt-key add -
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Setup the &lt;b&gt;stable&lt;/b&gt; repository. Make sure to select the proper architecture; in my case it's &lt;code&gt;amd64&lt;/code&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo add-apt-repository &lt;span class="se"&gt;\&lt;/span&gt;
    &lt;span class="s2"&gt;"deb [arch=amd64] https://download.docker.com/linux/ubuntu \&lt;/span&gt;
&lt;span class="s2"&gt;    &lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;lsb_release -cs&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt; \&lt;/span&gt;
&lt;span class="s2"&gt;    stable"&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Update the package index
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get update
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Install Docker
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get install docker-ce
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-3" class="outline-2"&gt;
&lt;h2 id="sec-3"&gt;Restore MySQL database to a Docker container&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Download the Docker image for &lt;code&gt;MySQL&lt;/code&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo docker pull mysql
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Create an empty database
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo docker run --name &amp;lt;container-name&amp;gt; -e &lt;span class="nv"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;lt;password&amp;gt; -e &lt;span class="nv"&gt;MYSQL_DATABASE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;lt;db-name&amp;gt; -d mysql
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;
This will create a new container with an empty database and login &lt;code&gt;root&lt;/code&gt;.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;Restore database from dump
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo docker &lt;span class="nb"&gt;exec&lt;/span&gt; -i &amp;lt;container-name&amp;gt; mysql -u&amp;lt;user-name&amp;gt; -p&amp;lt;password&amp;gt; --database&lt;span class="o"&gt;=&lt;/span&gt;&amp;lt;db-name&amp;gt; &amp;lt; &amp;lt;path-to-sql-file&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;
Notes:
&lt;/p&gt;
&lt;ol class="org-ol"&gt;
&lt;li&gt;Make sure that there is no space between &lt;code&gt;-u&lt;/code&gt; and &lt;code&gt;&amp;lt;user-name&amp;gt;&lt;/code&gt;, e.g. for user &lt;code&gt;root&lt;/code&gt; the option should be &lt;code&gt;-uroot&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;The same goes for password - e.g. if password is &lt;code&gt;my-secret&lt;/code&gt; then the option should be &lt;code&gt;-pmy-secret&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;path-to-sql-file&lt;/code&gt; should point to a file on host OS
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-4" class="outline-2"&gt;
&lt;h2 id="sec-4"&gt;Connect to MySQL database running on Docker container from Emacs&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-4"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;First, start the container &lt;code&gt;sudo docker start &amp;lt;container-name&amp;gt;&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;Get the IP Address of the container
&lt;/li&gt;
&lt;li&gt;Get the container configuration using &lt;code&gt;sudo docker inspect &amp;lt;container-name&amp;gt;&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;Copy the IP Address from the output under &lt;code&gt;NetworkSettings/IPAddress&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;In Emacs execute &lt;code&gt;M-x sql-mysql&lt;/code&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;For &lt;code&gt;User:&lt;/code&gt; enter the value for &lt;code&gt;&amp;lt;user-name&amp;gt;&lt;/code&gt; (&lt;code&gt;root&lt;/code&gt; is the default)
&lt;/li&gt;
&lt;li&gt;For &lt;code&gt;Password:&lt;/code&gt; enter the value for &lt;code&gt;&amp;lt;password&amp;gt;&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;For &lt;code&gt;Database:&lt;/code&gt; enter the value for &lt;code&gt;&amp;lt;db-name&amp;gt;&lt;/code&gt;
&lt;/li&gt;
&lt;li&gt;For &lt;code&gt;Server:&lt;/code&gt; enter the IP Address from 2.
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
That's it. Happy querying!
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>Docker</category><category>Emacs</category><category>sql-mode</category><guid>https://blog.rebeja.eu/posts/use-emacs-sql-mode-to-connect-to-database-on-a-docker-image/</guid><pubDate>Tue, 20 Jun 2017 22:00:00 GMT</pubDate></item><item><title>Editing remote files over ssh with Emacs and Tramp mode</title><link>https://blog.rebeja.eu/posts/editing-remote-files-over-ssh-with-emacs-and-tramp-mode/</link><dc:creator>Petru Rebeja</dc:creator><description>&lt;p&gt;
In a discussion over a beer, a friend of mine asked whether I know a way to edit remote files over &lt;code&gt;ssh&lt;/code&gt;? It was then that I realized that my long time obsession with Emacs is starting to pay off and I gave him the only way I know how to do that: &lt;b&gt;Emacs and &lt;a href="https://www.emacswiki.org/emacs/TrampMode"&gt;Tramp Mode&lt;/a&gt;&lt;/b&gt;.
&lt;/p&gt;

&lt;p&gt;
This is how I do it.
&lt;/p&gt;
&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Setup&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;p&gt;
I use &lt;code&gt;Emacs 25.2&lt;/code&gt; on Kubuntu 17.04 and on Windows 10 using &lt;a href="http://cygwin.com/"&gt;Cygwin&lt;/a&gt; and when working with remote files both systems behave the same.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;The flow&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;ol class="org-ol"&gt;
&lt;li&gt;Configure the remote machine to authenticate you with a key file as specified in this &lt;a href="https://askubuntu.com/a/20921/561980"&gt;stackoverflow answer&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;Start Emacs
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;
To open the remote file for editing invoke the &lt;code&gt;find-file&lt;/code&gt; command either using &lt;code&gt;C-x C-f&lt;/code&gt; (&lt;code&gt;C = Ctrl&lt;/code&gt;) or with &lt;code&gt;M-x find-file&lt;/code&gt; (&lt;code&gt;M=Alt&lt;/code&gt;) and at the file prompt specify the path in the following format:
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/ssh:user@ip&lt;span class="o"&gt;[&lt;/span&gt;:port&lt;span class="o"&gt;]&lt;/span&gt;:path/to/file
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-sec-3" class="outline-2"&gt;
&lt;h2 id="sec-3"&gt;An example&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;p&gt;
To exemplify let's consider the following scenario: I have a virtual machine with the IP &lt;code&gt;192.168.13.13&lt;/code&gt; to which I can connect remotely with &lt;code&gt;ssh&lt;/code&gt; using the username &lt;code&gt;petru&lt;/code&gt; and the default public key (&lt;b&gt;~/.ssh/id&lt;sub&gt;rsa&lt;/sub&gt;.pub&lt;/b&gt;). On that machine I want to edit the file &lt;code&gt;/home/petru/src/debugutils.py&lt;/code&gt;.
&lt;/p&gt;

&lt;p&gt;
To do so, I open the file as usually in Emacs using &lt;code&gt;C-x C-f&lt;/code&gt; and at the prompt (the minibuffer) I enter the following:
&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/ssh:petru@192.168.13.13:/home/petru/src/debugutils.py
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;
and press &lt;code&gt;&amp;lt;Enter&amp;gt;&lt;/code&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>Emacs</category><category>remote files</category><category>ssh</category><category>tramp</category><guid>https://blog.rebeja.eu/posts/editing-remote-files-over-ssh-with-emacs-and-tramp-mode/</guid><pubDate>Sun, 14 May 2017 22:00:00 GMT</pubDate></item></channel></rss>